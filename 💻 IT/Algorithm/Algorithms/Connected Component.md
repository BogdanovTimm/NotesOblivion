Very similar to the Union-Find one, but faster.